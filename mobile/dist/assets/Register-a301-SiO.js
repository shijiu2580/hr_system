import"./index-BfNrj1Io.js";import{C as x}from"./index-CcX8rTri.js";import{B as C}from"./index-ck5WoTsJ.js";import{F as U}from"./index-DmReRFXi.js";import{N as q}from"./index-QT4Twd0-.js";import{_ as B,u as N,a as P,b as S,c as F,f as t,e as d,w as m,g,t as R,r as p,s as i,j as I,k as w}from"./index-DE8r4v9z.js";import{F as T}from"./index-B3pv3eh3.js";import"./use-placeholder-33bInLsI.js";const h={class:"page-container"},j={class:"form-container"},z={style:{margin:"24px 16px"}},D={class:"footer-links"},E={__name:"Register",setup(G){const V=N(),_=P(),a=p({name:"",phone:"",email:"",code:"",password:"",confirmPassword:""}),v=p(!1),c=p(!1),u=p(0);function b(r){return r===a.value.password}async function y(){var r,e,n,l;if(!a.value.email){i("请先输入邮箱");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.value.email)){i("邮箱格式不正确");return}c.value=!0;try{const o=await I.post("/api/onboarding/send-code/",{email:a.value.email});if(o.data.success){w("验证码已发送"),u.value=60;const f=setInterval(()=>{u.value--,u.value<=0&&clearInterval(f)},1e3)}else i(((r=o.data.error)==null?void 0:r.message)||"发送失败")}catch(o){i(((l=(n=(e=o.response)==null?void 0:e.data)==null?void 0:n.error)==null?void 0:l.message)||"发送失败")}finally{c.value=!1}}async function k(){var r,e,n,l;v.value=!0;try{const o=await _.register({name:a.value.name,phone:a.value.phone,email:a.value.email,code:a.value.code,password:a.value.password});o.success?(w("注册成功"),V.replace("/profile")):i(((r=o.error)==null?void 0:r.message)||"注册失败")}catch(o){i(((l=(n=(e=o.response)==null?void 0:e.data)==null?void 0:n.error)==null?void 0:l.message)||"注册失败")}finally{v.value=!1}}return(r,e)=>{const n=q,l=U,o=C,f=x,$=T;return S(),F("div",h,[t(n,{title:"新员工注册","left-arrow":"",onClickLeft:e[0]||(e[0]=s=>r.$router.back())}),d("div",j,[e[9]||(e[9]=d("div",{class:"page-title"},"入职登记",-1)),e[10]||(e[10]=d("p",{class:"desc-text",style:{"text-align":"center","margin-bottom":"20px"}}," 请填写您的基本信息完成注册 ",-1)),t($,{onSubmit:k},{default:m(()=>[t(f,{inset:""},{default:m(()=>[t(l,{modelValue:a.value.name,"onUpdate:modelValue":e[1]||(e[1]=s=>a.value.name=s),name:"name",label:"姓名",placeholder:"请输入真实姓名",rules:[{required:!0,message:"请输入姓名"}]},null,8,["modelValue"]),t(l,{modelValue:a.value.phone,"onUpdate:modelValue":e[2]||(e[2]=s=>a.value.phone=s),name:"phone",label:"手机号",type:"tel",placeholder:"请输入手机号",rules:[{required:!0,message:"请输入手机号"},{pattern:/^1[3-9]\d{9}$/,message:"手机号格式不正确"}]},null,8,["modelValue"]),t(l,{modelValue:a.value.email,"onUpdate:modelValue":e[3]||(e[3]=s=>a.value.email=s),name:"email",label:"邮箱",type:"email",placeholder:"请输入邮箱（用于接收验证码）",rules:[{required:!0,message:"请输入邮箱"},{pattern:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"邮箱格式不正确"}]},null,8,["modelValue"]),t(l,{modelValue:a.value.code,"onUpdate:modelValue":e[4]||(e[4]=s=>a.value.code=s),name:"code",label:"验证码",placeholder:"请输入邮箱验证码",rules:[{required:!0,message:"请输入验证码"}]},{button:m(()=>[t(o,{size:"small",type:"primary",disabled:u.value>0,loading:c.value,onClick:y},{default:m(()=>[g(R(u.value>0?`${u.value}s`:"获取验证码"),1)]),_:1},8,["disabled","loading"])]),_:1},8,["modelValue"]),t(l,{modelValue:a.value.password,"onUpdate:modelValue":e[5]||(e[5]=s=>a.value.password=s),type:"password",name:"password",label:"密码",placeholder:"请设置登录密码（至少8位）",rules:[{required:!0,message:"请设置密码"},{pattern:/^.{8,}$/,message:"密码至少8位"}]},null,8,["modelValue"]),t(l,{modelValue:a.value.confirmPassword,"onUpdate:modelValue":e[6]||(e[6]=s=>a.value.confirmPassword=s),type:"password",name:"confirmPassword",label:"确认密码",placeholder:"请再次输入密码",rules:[{required:!0,message:"请确认密码"},{validator:b,message:"两次密码不一致"}]},null,8,["modelValue","rules"])]),_:1}),d("div",z,[t(o,{round:"",block:"",type:"primary","native-type":"submit",loading:v.value},{default:m(()=>[...e[8]||(e[8]=[g(" 注册 ",-1)])]),_:1},8,["loading"])])]),_:1}),d("div",D,[d("span",{onClick:e[7]||(e[7]=s=>r.$router.push("/login"))},"已有账号？立即登录")])])])}}},W=B(E,[["__scopeId","data-v-53045e74"]]);export{W as default};
