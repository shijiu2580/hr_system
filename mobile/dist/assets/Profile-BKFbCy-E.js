import"./index-BfNrj1Io.js";import{P as sa}from"./index-xRfbtRpH.js";/* empty css              */import{B as ra}from"./index-ck5WoTsJ.js";import{C as ua,a as da}from"./index-CcX8rTri.js";import{I as Xe}from"./index-D57cqCsI.js";import{F as ca}from"./index-DmReRFXi.js";import{N as va}from"./index-QT4Twd0-.js";import{l as se,m as W,n as ye,p as ce,q as H,v as Ye,x as je,y as ma,o as Ie,z as fa,A as Ze,B as ga,C as Ne,D as Re,f as o,r as _,E as ve,F as pa,G as N,H as ue,I as De,J as _e,K as ke,L as K,M as me,N as We,O as ee,P as he,Q as wa,R as He,S as qe,T as we,U as Pe,V as ba,W as ze,X as Oe,Y as be,Z as Ge,$ as ya,a0 as ie,a1 as de,a2 as Ke,a3 as Je,a4 as ha,a5 as xe,a6 as Va,a7 as ka,a8 as Ca,a9 as Te,aa as $e,ab as Qe,ac as ea,ad as Pa,ae as aa,af as xa,ag as Ia,_ as _a,u as Sa,a as Ua,b as Be,c as Ta,e as Q,ah as $a,ai as Ra,w as O,g as Oa,t as Da,aj as za,j as Ba,i as Ae,k as Me,s as ge}from"./index-DE8r4v9z.js";import{D as Aa}from"./index-CLhpQ3M_.js";import{F as Ma}from"./index-B3pv3eh3.js";import"./use-placeholder-33bInLsI.js";const[ta,Ve]=me("swipe"),Fa={loop:W,width:ye,height:ye,vertical:Boolean,autoplay:K(0),duration:K(500),touchable:W,lazyRender:Boolean,initialSwipe:K(0),indicatorColor:String,showIndicators:W,stopPropagation:W},la=Symbol(ta);var Ea=se({name:ta,props:Fa,emits:["change","dragStart","dragEnd"],setup(a,{emit:c,slots:v}){const t=_(),f=_(),n=ve({rect:null,width:0,height:0,offset:0,active:0,swiping:!1});let S=!1;const V=We(),{children:p,linkChildren:I}=pa(la),i=N(()=>p.length),g=N(()=>n[a.vertical?"height":"width"]),b=N(()=>a.vertical?V.deltaY.value:V.deltaX.value),C=N(()=>n.rect?(a.vertical?n.rect.height:n.rect.width)-g.value*i.value:0),$=N(()=>g.value?Math.ceil(Math.abs(C.value)/g.value):i.value),B=N(()=>i.value*g.value),P=N(()=>(n.active+i.value)%i.value),R=N(()=>{const d=a.vertical?"vertical":"horizontal";return V.direction.value===d}),z=N(()=>{const d={transitionDuration:`${n.swiping?0:a.duration}ms`,transform:`translate${a.vertical?"Y":"X"}(${+n.offset.toFixed(2)}px)`};if(g.value){const m=a.vertical?"height":"width",e=a.vertical?"width":"height";d[m]=`${B.value}px`,d[e]=a[e]?`${a[e]}px`:""}return d}),k=d=>{const{active:m}=n;return d?a.loop?ee(m+d,-1,i.value):ee(m+d,0,$.value):m},F=(d,m=0)=>{let e=d*g.value;a.loop||(e=Math.min(e,-C.value));let s=m-e;return a.loop||(s=ee(s,C.value,0)),s},U=({pace:d=0,offset:m=0,emitChange:e})=>{if(i.value<=1)return;const{active:s}=n,M=k(d),w=F(M,m);if(a.loop){if(p[0]&&w!==C.value){const X=w<C.value;p[0].setOffset(X?B.value:0)}if(p[i.value-1]&&w!==0){const X=w>0;p[i.value-1].setOffset(X?-B.value:0)}}n.active=M,n.offset=w,e&&M!==s&&c("change",P.value)},j=()=>{n.swiping=!0,n.active<=-1?U({pace:i.value}):n.active>=i.value&&U({pace:-i.value})},ae=()=>{j(),V.reset(),ue(()=>{n.swiping=!1,U({pace:-1,emitChange:!0})})},u=()=>{j(),V.reset(),ue(()=>{n.swiping=!1,U({pace:1,emitChange:!0})})};let x;const D=()=>clearTimeout(x),T=()=>{D(),+a.autoplay>0&&i.value>1&&(x=setTimeout(()=>{u(),T()},+a.autoplay))},E=(d=+a.initialSwipe)=>{if(!t.value)return;const m=()=>{var e,s;if(!De(t)){const M={width:t.value.offsetWidth,height:t.value.offsetHeight};n.rect=M,n.width=+((e=a.width)!=null?e:M.width),n.height=+((s=a.height)!=null?s:M.height)}i.value&&(d=Math.min(i.value-1,d),d===-1&&(d=i.value-1)),n.active=d,n.swiping=!0,n.offset=F(d),p.forEach(M=>{M.setOffset(0)}),T()};De(t)?_e().then(m):m()},Z=()=>E(n.active);let te;const J=d=>{!a.touchable||d.touches.length>1||(V.start(d),S=!1,te=Date.now(),D(),j())},r=d=>{a.touchable&&n.swiping&&(V.move(d),R.value&&(!a.loop&&(n.active===0&&b.value>0||n.active===i.value-1&&b.value<0)||(ke(d,a.stopPropagation),U({offset:b.value}),S||(c("dragStart",{index:P.value}),S=!0))))},y=()=>{if(!a.touchable||!n.swiping)return;const d=Date.now()-te,m=b.value/d;if((Math.abs(m)>.25||Math.abs(b.value)>g.value/2)&&R.value){const s=a.vertical?V.offsetY.value:V.offsetX.value;let M=0;a.loop?M=s>0?b.value>0?-1:1:0:M=-Math[b.value>0?"ceil":"floor"](b.value/g.value),U({pace:M,emitChange:!0})}else b.value&&U({pace:0});S=!1,n.swiping=!1,c("dragEnd",{index:P.value}),T()},h=(d,m={})=>{j(),V.reset(),ue(()=>{let e;a.loop&&d===i.value?e=n.active===0?0:d:e=d%i.value,m.immediate?ue(()=>{n.swiping=!1}):n.swiping=!1,U({pace:e-n.active,emitChange:!0})})},A=(d,m)=>{const e=m===P.value,s=e?{backgroundColor:a.indicatorColor}:void 0;return o("i",{style:s,class:Ve("indicator",{active:e})},null)},Y=()=>{if(v.indicator)return v.indicator({active:P.value,total:i.value});if(a.showIndicators&&i.value>1)return o("div",{class:Ve("indicators",{vertical:a.vertical})},[Array(i.value).fill("").map(A)])};return ce({prev:ae,next:u,state:n,resize:Z,swipeTo:h}),I({size:g,props:a,count:i,activeIndicator:P}),H(()=>a.initialSwipe,d=>E(+d)),H(i,()=>E(n.active)),H(()=>a.autoplay,T),H([Ye,je,()=>a.width,()=>a.height],Z),H(ma(),d=>{d==="visible"?T():D()}),Ie(E),fa(()=>E(n.active)),Ze(()=>E(n.active)),ga(D),Ne(D),Re("touchmove",r,{target:f}),()=>{var d;return o("div",{ref:t,class:Ve()},[o("div",{ref:f,style:z.value,class:Ve("track",{vertical:a.vertical}),onTouchstartPassive:J,onTouchend:y,onTouchcancel:y},[(d=v.default)==null?void 0:d.call(v)]),Y()])}}});const La=he(Ea),[Xa,Ya]=me("swipe-item");var ja=se({name:Xa,setup(a,{slots:c}){let v;const t=ve({offset:0,inited:!1,mounted:!1}),{parent:f,index:n}=wa(la);if(!f)return;const S=N(()=>{const I={},{vertical:i}=f.props;return f.size.value&&(I[i?"height":"width"]=`${f.size.value}px`),t.offset&&(I.transform=`translate${i?"Y":"X"}(${t.offset}px)`),I}),V=N(()=>{const{loop:I,lazyRender:i}=f.props;if(!i||v)return!0;if(!t.mounted)return!1;const g=f.activeIndicator.value,b=f.count.value-1,C=g===0&&I?b:g-1,$=g===b&&I?0:g+1;return v=n.value===g||n.value===C||n.value===$,v}),p=I=>{t.offset=I};return Ie(()=>{_e(()=>{t.mounted=!0})}),ce({setOffset:p}),()=>{var I;return o("div",{class:Ya(),style:S.value},[V.value?(I=c.default)==null?void 0:I.call(c):null])}}});const Za=he(ja),Fe=a=>Math.sqrt((a[0].clientX-a[1].clientX)**2+(a[0].clientY-a[1].clientY)**2),Na=a=>({x:(a[0].clientX+a[1].clientX)/2,y:(a[0].clientY+a[1].clientY)/2}),Ue=me("image-preview")[1],Ee=2.6,Wa={src:String,show:Boolean,active:Number,minZoom:we(ye),maxZoom:we(ye),rootWidth:we(Number),rootHeight:we(Number),disableZoom:Boolean,doubleScale:Boolean,closeOnClickImage:Boolean,closeOnClickOverlay:Boolean,vertical:Boolean};var Ha=se({props:Wa,emits:["scale","close","longPress"],setup(a,{emit:c,slots:v}){const t=ve({scale:1,moveX:0,moveY:0,moving:!1,zooming:!1,initializing:!1,imageRatio:0}),f=We(),n=_(),S=_(),V=_(!1),p=_(!1);let I=0;const i=N(()=>{const{scale:r,moveX:y,moveY:h,moving:A,zooming:Y,initializing:d}=t,m={transitionDuration:Y||A||d?"0s":".3s"};return(r!==1||p.value)&&(m.transform=`matrix(${r}, 0, 0, ${r}, ${y}, ${h})`),m}),g=N(()=>{if(t.imageRatio){const{rootWidth:r,rootHeight:y}=a,h=V.value?y/t.imageRatio:r;return Math.max(0,(t.scale*h-r)/2)}return 0}),b=N(()=>{if(t.imageRatio){const{rootWidth:r,rootHeight:y}=a,h=V.value?y:r*t.imageRatio;return Math.max(0,(t.scale*h-y)/2)}return 0}),C=(r,y)=>{var h;if(r=ee(r,+a.minZoom,+a.maxZoom+1),r!==t.scale){const A=r/t.scale;if(t.scale=r,y){const Y=Pe((h=n.value)==null?void 0:h.$el),d={x:Y.width*.5,y:Y.height*.5},m=t.moveX-(y.x-Y.left-d.x)*(A-1),e=t.moveY-(y.y-Y.top-d.y)*(A-1);t.moveX=ee(m,-g.value,g.value),t.moveY=ee(e,-b.value,b.value)}else t.moveX=0,t.moveY=p.value?I:0;c("scale",{scale:r,index:a.active})}},$=()=>{C(1)},B=()=>{const r=t.scale>1?1:2;C(r,r===2||p.value?{x:f.startX.value,y:f.startY.value}:void 0)};let P,R,z,k,F,U,j,ae,u=!1;const x=r=>{const{touches:y}=r;if(P=y.length,P===2&&a.disableZoom)return;const{offsetX:h}=f;f.start(r),R=t.moveX,z=t.moveY,ae=Date.now(),u=!1,t.moving=P===1&&(t.scale!==1||p.value),t.zooming=P===2&&!h.value,t.zooming&&(k=t.scale,F=Fe(y))},D=r=>{const{touches:y}=r;if(f.move(r),t.moving){const{deltaX:h,deltaY:A}=f,Y=h.value+R,d=A.value+z;if((a.vertical?f.isVertical()&&Math.abs(d)>b.value:f.isHorizontal()&&Math.abs(Y)>g.value)&&!u){t.moving=!1;return}u=!0,ke(r,!0),t.moveX=ee(Y,-g.value,g.value),t.moveY=ee(d,-b.value,b.value)}if(t.zooming&&(ke(r,!0),y.length===2)){const h=Fe(y),A=k*h/F;U=Na(y),C(A,U)}},T=r=>{var y;const h=(y=S.value)==null?void 0:y.$el;if(!h)return;const A=h.firstElementChild,Y=r.target===h,d=A==null?void 0:A.contains(r.target);!a.closeOnClickImage&&d||!a.closeOnClickOverlay&&Y||c("close")},E=r=>{if(P>1)return;const y=Date.now()-ae,h=250;f.isTap.value&&(y<h?a.doubleScale?j?(clearTimeout(j),j=null,B()):j=setTimeout(()=>{T(r),j=null},h):T(r):y>ba&&c("longPress"))},Z=r=>{let y=!1;if((t.moving||t.zooming)&&(y=!0,t.moving&&R===t.moveX&&z===t.moveY&&(y=!1),!r.touches.length)){t.zooming&&(t.moveX=ee(t.moveX,-g.value,g.value),t.moveY=ee(t.moveY,-b.value,b.value),t.zooming=!1),t.moving=!1,R=0,z=0,k=1,t.scale<1&&$();const h=+a.maxZoom;t.scale>h&&C(h,U)}ke(r,y),E(r),f.reset()},te=()=>{const{rootWidth:r,rootHeight:y}=a,h=y/r,{imageRatio:A}=t;V.value=t.imageRatio>h&&A<Ee,p.value=t.imageRatio>h&&A>=Ee,p.value&&(I=(A*r-y)/2,t.moveY=I,t.initializing=!0,He(()=>{t.initializing=!1})),$()},J=r=>{const{naturalWidth:y,naturalHeight:h}=r.target;t.imageRatio=h/y,te()};return H(()=>a.active,$),H(()=>a.show,r=>{r||$()}),H(()=>[a.rootWidth,a.rootHeight],te),Re("touchmove",D,{target:N(()=>{var r;return(r=S.value)==null?void 0:r.$el})}),ce({resetScale:$}),()=>{const r={loading:()=>o(qe,{type:"spinner"},null)};return o(Za,{ref:S,class:Ue("swipe-item"),onTouchstartPassive:x,onTouchend:Z,onTouchcancel:Z},{default:()=>[v.image?o("div",{class:Ue("image-wrap")},[v.image({src:a.src,onLoad:J,style:i.value})]):o(Xe,{ref:n,src:a.src,fit:"contain",class:Ue("image",{vertical:V.value}),style:i.value,onLoad:J},r)]})}}});const[qa,re]=me("image-preview"),Ga=["show","teleport","transition","overlayStyle","closeOnPopstate"],Ka={show:Boolean,loop:W,images:Ke(),minZoom:K(1/3),maxZoom:K(3),overlay:W,vertical:Boolean,closeable:Boolean,showIndex:W,className:ze,closeIcon:de("clear"),transition:String,beforeClose:Function,doubleScale:W,overlayClass:ze,overlayStyle:Object,swipeDuration:K(300),startPosition:K(0),showIndicators:Boolean,closeOnPopstate:W,closeOnClickImage:W,closeOnClickOverlay:W,closeIconPosition:de("top-right"),teleport:[String,Object]};var oa=se({name:qa,props:Ka,emits:["scale","close","closed","change","longPress","update:show"],setup(a,{emit:c,slots:v}){const t=_(),f=_(),n=ve({active:0,rootWidth:0,rootHeight:0,disableZoom:!1}),S=()=>{if(t.value){const k=Pe(t.value.$el);n.rootWidth=k.width,n.rootHeight=k.height,t.value.resize()}},V=k=>c("scale",k),p=k=>c("update:show",k),I=()=>{Je(a.beforeClose,{args:[n.active],done:()=>p(!1)})},i=k=>{k!==n.active&&(n.active=k,c("change",k))},g=()=>{if(a.showIndex)return o("div",{class:re("index")},[v.index?v.index({index:n.active}):`${n.active+1} / ${a.images.length}`])},b=()=>{if(v.cover)return o("div",{class:re("cover")},[v.cover()])},C=()=>{n.disableZoom=!0},$=()=>{n.disableZoom=!1},B=()=>o(La,{ref:t,lazyRender:!0,loop:a.loop,class:re("swipe"),vertical:a.vertical,duration:a.swipeDuration,initialSwipe:a.startPosition,showIndicators:a.showIndicators,indicatorColor:"white",onChange:i,onDragEnd:$,onDragStart:C},{default:()=>[a.images.map((k,F)=>o(Ha,{ref:U=>{F===n.active&&(f.value=U)},src:k,show:a.show,active:n.active,maxZoom:a.maxZoom,minZoom:a.minZoom,rootWidth:n.rootWidth,rootHeight:n.rootHeight,disableZoom:n.disableZoom,doubleScale:a.doubleScale,closeOnClickImage:a.closeOnClickImage,closeOnClickOverlay:a.closeOnClickOverlay,vertical:a.vertical,onScale:V,onClose:I,onLongPress:()=>c("longPress",{index:F})},{image:v.image}))]}),P=()=>{if(a.closeable)return o(ie,{role:"button",name:a.closeIcon,class:[re("close-icon",a.closeIconPosition),ya],onClick:I},null)},R=()=>c("closed"),z=(k,F)=>{var U;return(U=t.value)==null?void 0:U.swipeTo(k,F)};return ce({resetScale:()=>{var k;(k=f.value)==null||k.resetScale()},swipeTo:z}),Ie(S),H([Ye,je],S),H(()=>a.startPosition,k=>i(+k)),H(()=>a.show,k=>{const{images:F,startPosition:U}=a;k?(i(+U),_e(()=>{S(),z(+U,{immediate:!0})})):c("close",{index:n.active,url:F[n.active]})}),()=>o(Ge,Oe({class:[re(),a.className],overlayClass:[re("overlay"),a.overlayClass],onClosed:R,"onUpdate:show":p},be(a,Ga)),{default:()=>[P(),B(),g(),b()]})}});let Ce;const Ja={loop:!0,images:[],maxZoom:3,minZoom:1/3,onScale:void 0,onClose:void 0,onChange:void 0,vertical:!1,teleport:"body",className:"",showIndex:!0,closeable:!1,closeIcon:"clear",transition:void 0,beforeClose:void 0,doubleScale:!0,overlayStyle:void 0,overlayClass:void 0,startPosition:0,swipeDuration:300,showIndicators:!1,closeOnPopstate:!0,closeOnClickOverlay:!0,closeIconPosition:"top-right"};function Qa(){({instance:Ce}=Va({setup(){const{state:a,toggle:c}=ka(),v=()=>{a.images=[]};return()=>o(oa,Oe(a,{onClosed:v,"onUpdate:show":c}),null)}}))}const et=(a,c=0)=>{if(ha)return Ce||Qa(),a=Array.isArray(a)?{images:a,startPosition:c}:a,Ce.open(xe({},Ja,a)),Ce};he(oa);const[at,pe]=me("notice-bar"),tt={text:String,mode:String,color:String,delay:K(1),speed:K(60),leftIcon:String,wrapable:Boolean,background:String,scrollable:{type:Boolean,default:null}};var lt=se({name:at,props:tt,emits:["close","replay"],setup(a,{emit:c,slots:v}){let t=0,f=0,n;const S=_(),V=_(),p=ve({show:!0,offset:0,duration:0}),I=()=>{if(v["left-icon"])return v["left-icon"]();if(a.leftIcon)return o(ie,{class:pe("left-icon"),name:a.leftIcon},null)},i=()=>{if(a.mode==="closeable")return"cross";if(a.mode==="link")return"arrow"},g=P=>{a.mode==="closeable"&&(p.show=!1,c("close",P))},b=()=>{if(v["right-icon"])return v["right-icon"]();const P=i();if(P)return o(ie,{name:P,class:pe("right-icon"),onClick:g},null)},C=()=>{p.offset=t,p.duration=0,He(()=>{ue(()=>{p.offset=-f,p.duration=(f+t)/+a.speed,c("replay")})})},$=()=>{const P=a.scrollable===!1&&!a.wrapable,R={transform:p.offset?`translateX(${p.offset}px)`:"",transitionDuration:`${p.duration}s`};return o("div",{ref:S,role:"marquee",class:pe("wrap")},[o("div",{ref:V,style:R,class:[pe("content"),{"van-ellipsis":P}],onTransitionend:C},[v.default?v.default():a.text])])},B=()=>{const{delay:P,speed:R,scrollable:z}=a,k=Qe(P)?+P*1e3:0;t=0,f=0,p.offset=0,p.duration=0,clearTimeout(n),n=setTimeout(()=>{if(!S.value||!V.value||z===!1)return;const F=Pe(S).width,U=Pe(V).width;(z||U>F)&&ue(()=>{t=F,f=U,p.offset=-f,p.duration=f/+R})},k)};return Ze(B),Ca(B),Re("pageshow",B),ce({reset:B}),H(()=>[a.text,a.scrollable],B),()=>{const{color:P,wrapable:R,background:z}=a;return Te(o("div",{role:"alert",class:pe({wrapable:R}),style:{color:P,background:z}},[I(),$(),b()]),[[$e,p.show]])}}});const ot=he(lt),[nt,L,it]=me("uploader");function Le(a,c){return new Promise(v=>{if(c==="file"){v();return}const t=new FileReader;t.onload=f=>{v(f.target.result)},c==="dataUrl"?t.readAsDataURL(a):c==="text"&&t.readAsText(a)})}function na(a,c){return ea(a).some(v=>v.file?Pa(c)?c(v.file):v.file.size>+c:!1)}function st(a,c){const v=[],t=[];return a.forEach(f=>{na(f,c)?t.push(f):v.push(f)}),{valid:v,invalid:t}}const rt=/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg|avif)/i,ut=a=>rt.test(a);function ia(a){return a.isImage?!0:a.file&&a.file.type?a.file.type.indexOf("image")===0:a.url?ut(a.url):typeof a.content=="string"?a.content.indexOf("data:image")===0:!1}var dt=se({props:{name:ye,item:we(Object),index:Number,imageFit:String,lazyLoad:Boolean,deletable:Boolean,reupload:Boolean,previewSize:[Number,String,Array],beforeDelete:Function},emits:["delete","preview","reupload"],setup(a,{emit:c,slots:v}){const t=()=>{const{status:i,message:g}=a.item;if(i==="uploading"||i==="failed"){const b=i==="failed"?o(ie,{name:"close",class:L("mask-icon")},null):o(qe,{class:L("loading")},null),C=Qe(g)&&g!=="";return o("div",{class:L("mask")},[b,C&&o("div",{class:L("mask-message")},[g])])}},f=i=>{const{name:g,item:b,index:C,beforeDelete:$}=a;i.stopPropagation(),Je($,{args:[b,{name:g,index:C}],done:()=>c("delete")})},n=()=>c("preview"),S=()=>c("reupload"),V=()=>{if(a.deletable&&a.item.status!=="uploading"){const i=v["preview-delete"];return o("div",{role:"button",class:L("preview-delete",{shadow:!i}),tabindex:0,"aria-label":it("delete"),onClick:f},[i?i():o(ie,{name:"cross",class:L("preview-delete-icon")},null)])}},p=()=>{if(v["preview-cover"]){const{index:i,item:g}=a;return o("div",{class:L("preview-cover")},[v["preview-cover"](xe({index:i},g))])}},I=()=>{const{item:i,lazyLoad:g,imageFit:b,previewSize:C,reupload:$}=a;return ia(i)?o(Xe,{fit:b,src:i.objectUrl||i.content||i.url,class:L("preview-image"),width:Array.isArray(C)?C[0]:C,height:Array.isArray(C)?C[1]:C,lazyLoad:g,onClick:$?S:n},{default:p}):o("div",{class:L("file"),style:aa(a.previewSize)},[o(ie,{class:L("file-icon"),name:"description"},null),o("div",{class:[L("file-name"),"van-ellipsis"]},[i.file?i.file.name:i.url]),p()])};return()=>o("div",{class:L("preview")},[I(),t(),V()])}});const ct={name:K(""),accept:de("image/*"),capture:String,multiple:Boolean,disabled:Boolean,readonly:Boolean,lazyLoad:Boolean,maxCount:K(1/0),imageFit:de("cover"),resultType:de("dataUrl"),uploadIcon:de("photograph"),uploadText:String,deletable:W,reupload:Boolean,afterRead:Function,showUpload:W,modelValue:Ke(),beforeRead:Function,beforeDelete:Function,previewSize:[Number,String,Array],previewImage:W,previewOptions:Object,previewFullImage:W,maxSize:{type:[Number,String,Function],default:1/0}};var vt=se({name:nt,props:ct,emits:["delete","oversize","clickUpload","closePreview","clickPreview","clickReupload","update:modelValue"],setup(a,{emit:c,slots:v}){const t=_(),f=[],n=_(-1),S=_(!1),V=(u=a.modelValue.length)=>({name:a.name,index:u}),p=()=>{t.value&&(t.value.value="")},I=u=>{if(p(),na(u,a.maxSize))if(Array.isArray(u)){const x=st(u,a.maxSize);if(u=x.valid,c("oversize",x.invalid,V()),!u.length)return}else{c("oversize",u,V());return}if(u=ve(u),n.value>-1){const x=[...a.modelValue];x.splice(n.value,1,u),c("update:modelValue",x),n.value=-1}else c("update:modelValue",[...a.modelValue,...ea(u)]);a.afterRead&&a.afterRead(u,V())},i=u=>{const{maxCount:x,modelValue:D,resultType:T}=a;if(Array.isArray(u)){const E=+x-D.length;u.length>E&&(u=u.slice(0,E)),Promise.all(u.map(Z=>Le(Z,T))).then(Z=>{const te=u.map((J,r)=>{const y={file:J,status:"",message:"",objectUrl:URL.createObjectURL(J)};return Z[r]&&(y.content=Z[r]),y});I(te)})}else Le(u,T).then(E=>{const Z={file:u,status:"",message:"",objectUrl:URL.createObjectURL(u)};E&&(Z.content=E),I(Z)})},g=u=>{const{files:x}=u.target;if(a.disabled||!x||!x.length)return;const D=x.length===1?x[0]:[].slice.call(x);if(a.beforeRead){const T=a.beforeRead(D,V());if(!T){p();return}if(Ia(T)){T.then(E=>{i(E||D)}).catch(p);return}}i(D)};let b;const C=()=>c("closePreview"),$=u=>{if(a.previewFullImage){const x=a.modelValue.filter(ia),D=x.map(T=>(T.objectUrl&&!T.url&&T.status!=="failed"&&(T.url=T.objectUrl,f.push(T.url)),T.url)).filter(Boolean);b=et(xe({images:D,startPosition:x.indexOf(u),onClose:C},a.previewOptions))}},B=()=>{b&&b.close()},P=(u,x)=>{const D=a.modelValue.slice(0);D.splice(x,1),c("update:modelValue",D),c("delete",u,V(x))},R=u=>{S.value=!0,n.value=u,_e(()=>ae())},z=()=>{S.value||(n.value=-1),S.value=!1},k=(u,x)=>{const D=["imageFit","deletable","reupload","previewSize","beforeDelete"],T=xe(be(a,D),be(u,D,!0));return o(dt,Oe({item:u,index:x,onClick:()=>c(a.reupload?"clickReupload":"clickPreview",u,V(x)),onDelete:()=>P(u,x),onPreview:()=>$(u),onReupload:()=>R(x)},be(a,["name","lazyLoad"]),T),be(v,["preview-cover","preview-delete"]))},F=()=>{if(a.previewImage)return a.modelValue.map(k)},U=u=>c("clickUpload",u),j=()=>{const u=a.modelValue.length<+a.maxCount,x=a.readonly?null:o("input",{ref:t,type:"file",class:L("input"),accept:a.accept,capture:a.capture,multiple:a.multiple&&n.value===-1,disabled:a.disabled,onChange:g,onClick:z},null);return v.default?Te(o("div",{class:L("input-wrapper"),onClick:U},[v.default(),x]),[[$e,u]]):Te(o("div",{class:L("upload",{readonly:a.readonly}),style:aa(a.previewSize),onClick:U},[o(ie,{name:a.uploadIcon,class:L("upload-icon")},null),a.uploadText&&o("span",{class:L("upload-text")},[a.uploadText]),x]),[[$e,a.showUpload&&u]])},ae=()=>{t.value&&!a.disabled&&t.value.click()};return Ne(()=>{f.forEach(u=>URL.revokeObjectURL(u))}),ce({chooseFile:ae,reuploadFile:R,closeImagePreview:B}),xa(()=>a.modelValue),()=>o("div",{class:L()},[o("div",{class:L("wrapper",{disabled:a.disabled})},[F(),j()])])}});const mt=he(vt),ft={class:"page-container"},gt={class:"form-container"},pt={style:{margin:"24px 16px"}},wt={__name:"Profile",setup(a){const c=Sa(),v=Ua(),t=_({name:"",english_name:"",gender:"",birth_date:"",id_card:"",passport_no:"",phone:"",email:"",nationality:"中国",hukou_location:"",hukou_type:"",native_place:"",hukou_address:"",ethnicity:"汉族",blood_type:"",marital_status:"",political_status:"",party_date:"",address:"",emergency_contact:"",emergency_relation:"",emergency_phone:"",school_type:"",school_name:"",major:"",graduation_date:"",education:"",bank_card_no:"",expense_card_no:"",computer_info:"",computer_brand:""}),f=_(!1),n=_(""),S=_([]),V=_([]),p=_([]),I=_(!1),i=_(!1),g=_(!1),b=_(!1),C=_(!1),$=_(!1),B=_(!1),P=_(!1),R=_(!1),z=_(!1),k=_(!1),F=_(["1995","01","01"]),U=_(["2020","01","01"]),j=_(["2020","06","01"]),ae=["男","女"],u=["农村","城镇"],x=["A型","B型","O型","AB型","未知"],D=["未婚","已婚","离异","丧偶"],T=["群众","共青团员","中共党员","民主党派","其他"],E=["普通本科","211","985","双一流","大专","高中/中专","其他"],Z=["高中/中专","大专","本科","硕士","博士"],te=["自带","公司配发"],J={M:"男",F:"女"},r={single:"未婚",married:"已婚",divorced:"离异",widowed:"丧偶"};Ie(async()=>{await v.checkAuth(),await y()});async function y(){var m;try{const e=await v.fetchProfile();if(e.success){const s=e.data;t.value={name:s.name||"",english_name:s.english_name||"",gender:J[s.gender]||"",birth_date:s.birth_date||"",id_card:s.id_card||"",passport_no:s.passport_no||"",phone:s.phone||"",email:s.email||((m=v.userInfo)==null?void 0:m.email)||"",nationality:s.nationality||"中国",hukou_location:s.hukou_location||"",hukou_type:s.hukou_type||"",native_place:s.native_place||"",hukou_address:s.hukou_address||"",ethnicity:s.ethnicity||"汉族",blood_type:s.blood_type||"",marital_status:r[s.marital_status]||"",political_status:s.political_status||"",party_date:s.party_date||"",address:s.address||"",emergency_contact:s.emergency_contact||"",emergency_relation:s.emergency_relation||"",emergency_phone:s.emergency_phone||"",school_type:s.school_type||"",school_name:s.school_name||"",major:s.major||"",graduation_date:s.graduation_date||"",education:s.education||"",bank_card_no:s.bank_card_no||"",expense_card_no:s.expense_card_no||"",computer_info:s.computer_info||"",computer_brand:s.computer_brand||""},n.value=s.onboard_reject_reason||"",s.avatar&&(S.value=[{url:s.avatar,isImage:!0}]),s.id_card_front&&(V.value=[{url:s.id_card_front,isImage:!0}]),s.id_card_back&&(p.value=[{url:s.id_card_back,isImage:!0}])}}catch(e){console.error(e)}}function h(m,{selectedOptions:e}){t.value[m]=e[0],m==="gender"&&(I.value=!1),m==="hukou_type"&&(g.value=!1),m==="blood_type"&&(b.value=!1),m==="marital_status"&&(C.value=!1),m==="political_status"&&($.value=!1),m==="school_type"&&(P.value=!1),m==="education"&&(z.value=!1),m==="computer_info"&&(k.value=!1)}function A(m,{selectedValues:e}){t.value[m]=e.join("-"),m==="birth_date"&&(i.value=!1),m==="party_date"&&(B.value=!1),m==="graduation_date"&&(R.value=!1)}async function Y(m,e){var M,w,X,le;const s=new FormData;s.append(e,m.file),za({message:"上传中...",forbidClick:!0});try{const q=await Ba.post("/api/onboarding/profile/",s,{headers:{"Content-Type":"multipart/form-data"}});Ae(),q.data.success?(Me("上传成功"),await v.fetchProfile()):ge(((M=q.data.error)==null?void 0:M.message)||"上传失败")}catch(q){Ae(),ge(((le=(X=(w=q.response)==null?void 0:w.data)==null?void 0:X.error)==null?void 0:le.message)||"上传失败"),e==="avatar"&&(S.value=[]),e==="id_card_front"&&(V.value=[]),e==="id_card_back"&&(p.value=[])}}async function d(){var s,M,w,X,le,q;if(S.value.length===0){ge("请上传照片");return}f.value=!0;const m=((s=Object.entries(J).find(([oe,fe])=>fe===t.value.gender))==null?void 0:s[0])||"",e=((M=Object.entries(r).find(([oe,fe])=>fe===t.value.marital_status))==null?void 0:M[0])||"";try{const oe=await v.updateProfile({...t.value,gender:m,marital_status:e});oe.success?(Me("提交成功"),c.push("/status")):ge(((w=oe.error)==null?void 0:w.message)||"提交失败")}catch(oe){ge(((q=(le=(X=oe.response)==null?void 0:X.data)==null?void 0:le.error)==null?void 0:q.message)||"提交失败")}finally{f.value=!1}}return(m,e)=>{const s=va,M=ot,w=ca,X=ua,le=mt,q=da,oe=ra,fe=Ma,ne=sa,G=Ge,Se=Aa;return Be(),Ta("div",ft,[o(s,{title:"完善资料","left-arrow":"",onClickLeft:e[0]||(e[0]=l=>m.$router.back())}),Q("div",gt,[n.value?(Be(),$a(M,{key:0,color:"#ee0a24",background:"#ffece8","left-icon":"info-o",text:`审核未通过：${n.value}，请修改后重新提交`},null,8,["text"])):Ra("",!0),o(fe,{onSubmit:d,ref:"formRef"},{default:O(()=>[e[82]||(e[82]=Q("div",{class:"section-title"},"基本信息",-1)),o(X,{inset:""},{default:O(()=>[o(w,{modelValue:t.value.name,"onUpdate:modelValue":e[1]||(e[1]=l=>t.value.name=l),label:"姓名",placeholder:"请输入",required:"",rules:[{required:!0,message:"请输入姓名"}]},null,8,["modelValue"]),o(w,{modelValue:t.value.english_name,"onUpdate:modelValue":e[2]||(e[2]=l=>t.value.english_name=l),label:"英文名",placeholder:"请输入"},null,8,["modelValue"]),o(w,{modelValue:t.value.gender,"onUpdate:modelValue":e[3]||(e[3]=l=>t.value.gender=l),"is-link":"",readonly:"",label:"性别",placeholder:"请选择",onClick:e[4]||(e[4]=l=>I.value=!0)},null,8,["modelValue"]),o(w,{modelValue:t.value.birth_date,"onUpdate:modelValue":e[5]||(e[5]=l=>t.value.birth_date=l),"is-link":"",readonly:"",label:"出生日期",placeholder:"请选择",onClick:e[6]||(e[6]=l=>i.value=!0)},null,8,["modelValue"]),o(w,{modelValue:t.value.id_card,"onUpdate:modelValue":e[7]||(e[7]=l=>t.value.id_card=l),label:"证件号码",placeholder:"身份证号"},null,8,["modelValue"]),o(w,{modelValue:t.value.passport_no,"onUpdate:modelValue":e[8]||(e[8]=l=>t.value.passport_no=l),label:"护照号码",placeholder:"选填"},null,8,["modelValue"]),o(w,{modelValue:t.value.phone,"onUpdate:modelValue":e[9]||(e[9]=l=>t.value.phone=l),label:"手机号码",type:"tel",placeholder:"请输入",required:"",rules:[{required:!0,message:"请输入手机号码"},{pattern:/^1[3-9]\d{9}$/,message:"手机号格式不正确"}]},null,8,["modelValue"]),o(w,{modelValue:t.value.email,"onUpdate:modelValue":e[10]||(e[10]=l=>t.value.email=l),label:"电子邮箱",placeholder:"请输入",readonly:"",required:"",rules:[{required:!0,message:"请输入电子邮箱"}]},null,8,["modelValue"])]),_:1}),e[83]||(e[83]=Q("div",{class:"section-title"},"户籍信息",-1)),o(X,{inset:""},{default:O(()=>[o(w,{modelValue:t.value.nationality,"onUpdate:modelValue":e[11]||(e[11]=l=>t.value.nationality=l),label:"国籍(地区)",placeholder:"请输入"},null,8,["modelValue"]),o(w,{modelValue:t.value.hukou_location,"onUpdate:modelValue":e[12]||(e[12]=l=>t.value.hukou_location=l),label:"户籍所在地",placeholder:"请输入"},null,8,["modelValue"]),o(w,{modelValue:t.value.hukou_type,"onUpdate:modelValue":e[13]||(e[13]=l=>t.value.hukou_type=l),"is-link":"",readonly:"",label:"户籍性质",placeholder:"请选择",onClick:e[14]||(e[14]=l=>g.value=!0)},null,8,["modelValue"]),o(w,{modelValue:t.value.native_place,"onUpdate:modelValue":e[15]||(e[15]=l=>t.value.native_place=l),label:"籍贯",placeholder:"如：四川省/宜宾市"},null,8,["modelValue"]),o(w,{modelValue:t.value.hukou_address,"onUpdate:modelValue":e[16]||(e[16]=l=>t.value.hukou_address=l),label:"户籍地址",type:"textarea",rows:"2",placeholder:"请输入"},null,8,["modelValue"]),o(w,{modelValue:t.value.ethnicity,"onUpdate:modelValue":e[17]||(e[17]=l=>t.value.ethnicity=l),label:"民族",placeholder:"请输入"},null,8,["modelValue"]),o(w,{modelValue:t.value.blood_type,"onUpdate:modelValue":e[18]||(e[18]=l=>t.value.blood_type=l),"is-link":"",readonly:"",label:"血型",placeholder:"请选择",onClick:e[19]||(e[19]=l=>b.value=!0)},null,8,["modelValue"]),o(w,{modelValue:t.value.marital_status,"onUpdate:modelValue":e[20]||(e[20]=l=>t.value.marital_status=l),"is-link":"",readonly:"",label:"婚姻状况",placeholder:"请选择",onClick:e[21]||(e[21]=l=>C.value=!0)},null,8,["modelValue"]),o(w,{modelValue:t.value.political_status,"onUpdate:modelValue":e[22]||(e[22]=l=>t.value.political_status=l),"is-link":"",readonly:"",label:"政治面貌",placeholder:"请选择",onClick:e[23]||(e[23]=l=>$.value=!0)},null,8,["modelValue"]),o(w,{modelValue:t.value.party_date,"onUpdate:modelValue":e[24]||(e[24]=l=>t.value.party_date=l),"is-link":"",readonly:"",label:"入党/团日期",placeholder:"请选择",onClick:e[25]||(e[25]=l=>B.value=!0)},null,8,["modelValue"])]),_:1}),e[84]||(e[84]=Q("div",{class:"section-title"},"联系信息",-1)),o(X,{inset:""},{default:O(()=>[o(w,{modelValue:t.value.address,"onUpdate:modelValue":e[26]||(e[26]=l=>t.value.address=l),label:"联系地址",type:"textarea",rows:"2",placeholder:"请输入详细地址"},null,8,["modelValue"])]),_:1}),e[85]||(e[85]=Q("div",{class:"section-title"},"紧急联系人",-1)),o(X,{inset:""},{default:O(()=>[o(w,{modelValue:t.value.emergency_contact,"onUpdate:modelValue":e[27]||(e[27]=l=>t.value.emergency_contact=l),label:"联系人姓名",placeholder:"请输入"},null,8,["modelValue"]),o(w,{modelValue:t.value.emergency_relation,"onUpdate:modelValue":e[28]||(e[28]=l=>t.value.emergency_relation=l),label:"与本人关系",placeholder:"如：父亲"},null,8,["modelValue"]),o(w,{modelValue:t.value.emergency_phone,"onUpdate:modelValue":e[29]||(e[29]=l=>t.value.emergency_phone=l),label:"联系电话",type:"tel",placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e[86]||(e[86]=Q("div",{class:"section-title"},"教育信息",-1)),o(X,{inset:""},{default:O(()=>[o(w,{modelValue:t.value.school_type,"onUpdate:modelValue":e[30]||(e[30]=l=>t.value.school_type=l),"is-link":"",readonly:"",label:"学校分类",placeholder:"请选择",onClick:e[31]||(e[31]=l=>P.value=!0)},null,8,["modelValue"]),o(w,{modelValue:t.value.school_name,"onUpdate:modelValue":e[32]||(e[32]=l=>t.value.school_name=l),label:"毕业学校",placeholder:"请输入"},null,8,["modelValue"]),o(w,{modelValue:t.value.major,"onUpdate:modelValue":e[33]||(e[33]=l=>t.value.major=l),label:"专业",placeholder:"请输入"},null,8,["modelValue"]),o(w,{modelValue:t.value.graduation_date,"onUpdate:modelValue":e[34]||(e[34]=l=>t.value.graduation_date=l),"is-link":"",readonly:"",label:"毕业时间",placeholder:"请选择",onClick:e[35]||(e[35]=l=>R.value=!0)},null,8,["modelValue"]),o(w,{modelValue:t.value.education,"onUpdate:modelValue":e[36]||(e[36]=l=>t.value.education=l),"is-link":"",readonly:"",label:"学历",placeholder:"请选择",onClick:e[37]||(e[37]=l=>z.value=!0)},null,8,["modelValue"])]),_:1}),e[87]||(e[87]=Q("div",{class:"section-title"},"银行信息",-1)),o(X,{inset:""},{default:O(()=>[o(w,{modelValue:t.value.bank_card_no,"onUpdate:modelValue":e[38]||(e[38]=l=>t.value.bank_card_no=l),label:"工资卡账号",placeholder:"请输入"},null,8,["modelValue"]),o(w,{modelValue:t.value.expense_card_no,"onUpdate:modelValue":e[39]||(e[39]=l=>t.value.expense_card_no=l),label:"报销卡账号",placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e[88]||(e[88]=Q("div",{class:"section-title"},"设备信息",-1)),o(X,{inset:""},{default:O(()=>[o(w,{modelValue:t.value.computer_info,"onUpdate:modelValue":e[40]||(e[40]=l=>t.value.computer_info=l),"is-link":"",readonly:"",label:"电脑信息",placeholder:"请选择",onClick:e[41]||(e[41]=l=>k.value=!0)},null,8,["modelValue"]),o(w,{modelValue:t.value.computer_brand,"onUpdate:modelValue":e[42]||(e[42]=l=>t.value.computer_brand=l),label:"电脑品牌",placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e[89]||(e[89]=Q("div",{class:"section-title"},"证件上传",-1)),o(X,{inset:""},{default:O(()=>[o(q,{title:"照片",required:""},{value:O(()=>[o(le,{modelValue:S.value,"onUpdate:modelValue":e[43]||(e[43]=l=>S.value=l),"max-count":1,"after-read":l=>Y(l,"avatar")},null,8,["modelValue","after-read"])]),_:1}),o(q,{title:"身份证人像面"},{value:O(()=>[o(le,{modelValue:V.value,"onUpdate:modelValue":e[44]||(e[44]=l=>V.value=l),"max-count":1,"after-read":l=>Y(l,"id_card_front")},null,8,["modelValue","after-read"])]),_:1}),o(q,{title:"身份证国徽面"},{value:O(()=>[o(le,{modelValue:p.value,"onUpdate:modelValue":e[45]||(e[45]=l=>p.value=l),"max-count":1,"after-read":l=>Y(l,"id_card_back")},null,8,["modelValue","after-read"])]),_:1})]),_:1}),Q("div",pt,[o(oe,{round:"",block:"",type:"primary","native-type":"submit",loading:f.value},{default:O(()=>[Oa(Da(n.value?"重新提交":"提交资料"),1)]),_:1},8,["loading"])])]),_:1},512)]),o(G,{show:I.value,"onUpdate:show":e[48]||(e[48]=l=>I.value=l),position:"bottom"},{default:O(()=>[o(ne,{columns:ae,onConfirm:e[46]||(e[46]=l=>h("gender",l)),onCancel:e[47]||(e[47]=l=>I.value=!1)})]),_:1},8,["show"]),o(G,{show:i.value,"onUpdate:show":e[52]||(e[52]=l=>i.value=l),position:"bottom"},{default:O(()=>[o(Se,{modelValue:F.value,"onUpdate:modelValue":e[49]||(e[49]=l=>F.value=l),"min-date":new Date(1950,0,1),"max-date":new Date(2010,11,31),onConfirm:e[50]||(e[50]=l=>A("birth_date",l)),onCancel:e[51]||(e[51]=l=>i.value=!1)},null,8,["modelValue","min-date","max-date"])]),_:1},8,["show"]),o(G,{show:g.value,"onUpdate:show":e[55]||(e[55]=l=>g.value=l),position:"bottom"},{default:O(()=>[o(ne,{columns:u,onConfirm:e[53]||(e[53]=l=>h("hukou_type",l)),onCancel:e[54]||(e[54]=l=>g.value=!1)})]),_:1},8,["show"]),o(G,{show:b.value,"onUpdate:show":e[58]||(e[58]=l=>b.value=l),position:"bottom"},{default:O(()=>[o(ne,{columns:x,onConfirm:e[56]||(e[56]=l=>h("blood_type",l)),onCancel:e[57]||(e[57]=l=>b.value=!1)})]),_:1},8,["show"]),o(G,{show:C.value,"onUpdate:show":e[61]||(e[61]=l=>C.value=l),position:"bottom"},{default:O(()=>[o(ne,{columns:D,onConfirm:e[59]||(e[59]=l=>h("marital_status",l)),onCancel:e[60]||(e[60]=l=>C.value=!1)})]),_:1},8,["show"]),o(G,{show:$.value,"onUpdate:show":e[64]||(e[64]=l=>$.value=l),position:"bottom"},{default:O(()=>[o(ne,{columns:T,onConfirm:e[62]||(e[62]=l=>h("political_status",l)),onCancel:e[63]||(e[63]=l=>$.value=!1)})]),_:1},8,["show"]),o(G,{show:B.value,"onUpdate:show":e[68]||(e[68]=l=>B.value=l),position:"bottom"},{default:O(()=>[o(Se,{modelValue:U.value,"onUpdate:modelValue":e[65]||(e[65]=l=>U.value=l),"min-date":new Date(1950,0,1),"max-date":new Date,onConfirm:e[66]||(e[66]=l=>A("party_date",l)),onCancel:e[67]||(e[67]=l=>B.value=!1)},null,8,["modelValue","min-date","max-date"])]),_:1},8,["show"]),o(G,{show:P.value,"onUpdate:show":e[71]||(e[71]=l=>P.value=l),position:"bottom"},{default:O(()=>[o(ne,{columns:E,onConfirm:e[69]||(e[69]=l=>h("school_type",l)),onCancel:e[70]||(e[70]=l=>P.value=!1)})]),_:1},8,["show"]),o(G,{show:R.value,"onUpdate:show":e[75]||(e[75]=l=>R.value=l),position:"bottom"},{default:O(()=>[o(Se,{modelValue:j.value,"onUpdate:modelValue":e[72]||(e[72]=l=>j.value=l),"min-date":new Date(1980,0,1),"max-date":new Date(2030,11,31),onConfirm:e[73]||(e[73]=l=>A("graduation_date",l)),onCancel:e[74]||(e[74]=l=>R.value=!1)},null,8,["modelValue","min-date","max-date"])]),_:1},8,["show"]),o(G,{show:z.value,"onUpdate:show":e[78]||(e[78]=l=>z.value=l),position:"bottom"},{default:O(()=>[o(ne,{columns:Z,onConfirm:e[76]||(e[76]=l=>h("education",l)),onCancel:e[77]||(e[77]=l=>z.value=!1)})]),_:1},8,["show"]),o(G,{show:k.value,"onUpdate:show":e[81]||(e[81]=l=>k.value=l),position:"bottom"},{default:O(()=>[o(ne,{columns:te,onConfirm:e[79]||(e[79]=l=>h("computer_info",l)),onCancel:e[80]||(e[80]=l=>k.value=!1)})]),_:1},8,["show"])])}}},Tt=_a(wt,[["__scopeId","data-v-a1676b1b"]]);export{Tt as default};
