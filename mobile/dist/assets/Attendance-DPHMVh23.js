import"./index-BfNrj1Io.js";import{T as q,a as z}from"./index-PtygPl2G.js";/* empty css              */import"./index-xRfbtRpH.js";import{L as G,T as H,P as J}from"./index-qycBzvOQ.js";import{N as K}from"./index-QT4Twd0-.js";import{_ as O,r as i,o as Q,j as X,b as h,c as k,f as o,e,a0 as tt,t as l,w as d,al as et,ap as at,g as p,Z as st}from"./index-DE8r4v9z.js";import{D as nt}from"./index-CLhpQ3M_.js";import"./use-placeholder-33bInLsI.js";const ot={class:"page-container"},lt={class:"month-selector"},it={class:"stats-card card"},rt={class:"stat-item"},dt={class:"stat-value"},ut={class:"stat-item"},ct={class:"stat-value late"},vt={class:"stat-item"},_t={class:"stat-value early"},pt={class:"stat-item"},mt={class:"stat-value absent"},ft={class:"record-date"},yt={class:"date-day"},gt={class:"date-week"},bt={class:"record-info"},ht={class:"time-row"},kt={class:"time-value"},wt={class:"time-row"},Dt={class:"time-value"},Vt={class:"record-status"},xt={__name:"Attendance",setup(St){const w=i(0),D=new Date,r=i(D.getFullYear()),n=i(D.getMonth()+1),c=i(!1),V=i([String(r.value),String(n.value).padStart(2,"0")]),m=i([]),v=i({total:0,late:0,early:0,absent:0}),f=i(!1),y=i(!1),g=i(!1),T=["周日","周一","周二","周三","周四","周五","周六"];Q(()=>{_()});async function _(){const a=`${r.value}-${String(n.value).padStart(2,"0")}-01`,t=`${r.value}-${String(n.value).padStart(2,"0")}-31`;try{const u=await X.get("/api/attendance/my/",{params:{date_from:a,date_to:t}});u.data.success&&(m.value=u.data.data||[],C())}catch(u){console.error(u)}f.value=!1,y.value=!1,g.value=!0}function C(){const a={total:0,late:0,early:0,absent:0};m.value.forEach(t=>{(t.check_in_time||t.check_out_time)&&a.total++,t.attendance_type==="late"&&a.late++,t.attendance_type==="early_leave"&&a.early++,t.attendance_type==="absent"&&a.absent++}),v.value=a}function $(){n.value===1?(n.value=12,r.value--):n.value--,_()}function I(){const a=new Date;r.value===a.getFullYear()&&n.value===a.getMonth()+1||(n.value===12?(n.value=1,r.value++):n.value++,_())}function L({selectedValues:a}){r.value=parseInt(a[0]),n.value=parseInt(a[1]),c.value=!1,_()}function N(){_()}function P(){g.value=!0}function U(a){return parseInt(a.split("-")[2])}function B(a){return T[new Date(a).getDay()]}function R(a){return{check_in:"primary",check_out:"success",late:"warning",early_leave:"danger",absent:"danger",leave:"primary"}[a]||"default"}function F(a){return{check_in:"已签到",check_out:"正常",late:"迟到",early_leave:"早退",absent:"缺勤",leave:"请假"}[a]||a}return(a,t)=>{const u=K,x=tt,Y=H,A=G,E=J,j=nt,W=st,b=q,Z=z;return h(),k("div",ot,[o(u,{title:"考勤记录","left-arrow":"",onClickLeft:t[0]||(t[0]=s=>a.$router.back())}),e("div",lt,[o(x,{name:"arrow-left",onClick:$}),e("span",{class:"month-text",onClick:t[1]||(t[1]=s=>c.value=!0)},l(r.value)+"年"+l(n.value)+"月 ",1),o(x,{name:"arrow",onClick:I})]),e("div",it,[e("div",rt,[e("div",dt,l(v.value.total),1),t[8]||(t[8]=e("div",{class:"stat-label"},"出勤天数",-1))]),e("div",ut,[e("div",ct,l(v.value.late),1),t[9]||(t[9]=e("div",{class:"stat-label"},"迟到",-1))]),e("div",vt,[e("div",_t,l(v.value.early),1),t[10]||(t[10]=e("div",{class:"stat-label"},"早退",-1))]),e("div",pt,[e("div",mt,l(v.value.absent),1),t[11]||(t[11]=e("div",{class:"stat-label"},"缺勤",-1))])]),o(E,{modelValue:f.value,"onUpdate:modelValue":t[3]||(t[3]=s=>f.value=s),onRefresh:N},{default:d(()=>[o(A,{loading:y.value,"onUpdate:loading":t[2]||(t[2]=s=>y.value=s),finished:g.value,"finished-text":"没有更多了",onLoad:P},{default:d(()=>[(h(!0),k(et,null,at(m.value,s=>{var S,M;return h(),k("div",{key:s.id,class:"record-item card"},[e("div",ft,[e("div",yt,l(U(s.date)),1),e("div",gt,l(B(s.date)),1)]),e("div",bt,[e("div",ht,[t[12]||(t[12]=e("span",{class:"time-label"},"签到",-1)),e("span",kt,l(((S=s.check_in_time)==null?void 0:S.slice(0,5))||"--:--"),1)]),e("div",wt,[t[13]||(t[13]=e("span",{class:"time-label"},"签退",-1)),e("span",Dt,l(((M=s.check_out_time)==null?void 0:M.slice(0,5))||"--:--"),1)])]),e("div",Vt,[o(Y,{type:R(s.attendance_type)},{default:d(()=>[p(l(F(s.attendance_type)),1)]),_:2},1032,["type"])])])}),128))]),_:1},8,["loading","finished"])]),_:1},8,["modelValue"]),o(W,{show:c.value,"onUpdate:show":t[6]||(t[6]=s=>c.value=s),position:"bottom"},{default:d(()=>[o(j,{modelValue:V.value,"onUpdate:modelValue":t[4]||(t[4]=s=>V.value=s),type:"year-month","min-date":new Date(2020,0),"max-date":new Date,onConfirm:L,onCancel:t[5]||(t[5]=s=>c.value=!1)},null,8,["modelValue","min-date","max-date"])]),_:1},8,["show"]),o(Z,{modelValue:w.value,"onUpdate:modelValue":t[7]||(t[7]=s=>w.value=s),fixed:""},{default:d(()=>[o(b,{icon:"home-o",to:"/home"},{default:d(()=>[...t[14]||(t[14]=[p("首页",-1)])]),_:1}),o(b,{icon:"location-o",to:"/checkin"},{default:d(()=>[...t[15]||(t[15]=[p("打卡",-1)])]),_:1}),o(b,{icon:"user-o",to:"/me"},{default:d(()=>[...t[16]||(t[16]=[p("我的",-1)])]),_:1})]),_:1},8,["modelValue"])])}}},Bt=O(xt,[["__scopeId","data-v-0e19ae56"]]);export{Bt as default};
